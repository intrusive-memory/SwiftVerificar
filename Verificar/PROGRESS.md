# Verificar Progress

## Current State
- Last completed sprint: 14
- Last commit hash: 3c0715c
- Build status: passing
- Total test count: 167 (163 unit tests + 4 UI tests from template)
- **App status: IN PROGRESS**

## Completed Sprints
- Sprint 1: Project Cleanup & PDF Document Type Configuration
- Sprint 2: PDF Document Model & File Opening
- Sprint 3: PDFKit View Integration & Basic Rendering
- Sprint 4: Three-Column Layout Shell
- Sprint 5: Page Thumbnails Sidebar
- Sprint 6: Document Outline Sidebar
- Sprint 7: Toolbar & Navigation Controls
- Sprint 8: SwiftVerificar Package Dependency & Validation Service
- Sprint 9: Validation Orchestration & State Management
- Sprint 10: Accessibility Standards Panel
- Sprint 11: Violations List View
- Sprint 12: Violation Detail View
- Sprint 13: Structure Tree Visualization
- Sprint 14: Feature Extraction Panel

## Next Sprint
- Sprint 15: Violation Highlighting & Report Export

## Files Created (cumulative)
### Sources
- Verificar/App/VerificarApp.swift
- Verificar/Views/ContentView.swift
- Verificar/Views/PDF/PDFViewRepresentable.swift
- Verificar/Views/PDF/PDFRenderView.swift
- Verificar/Views/Sidebar/SidebarView.swift
- Verificar/Views/Sidebar/ThumbnailSidebarView.swift
- Verificar/Views/Inspector/InspectorView.swift
- Verificar/Models/PDFDocumentModel.swift
- Verificar/Models/OutlineNode.swift
- Verificar/Views/Sidebar/OutlineSidebarView.swift
- Verificar/Views/Toolbar/ToolbarContent.swift
- Verificar/Utilities/PDFKitExtensions.swift
- Verificar/Services/ValidationService.swift
- Verificar/Models/ValidationState.swift
- Verificar/ViewModels/DocumentViewModel.swift
- Verificar/ViewModels/ValidationViewModel.swift
- Verificar/Views/Inspector/StandardsPanel.swift
- Verificar/Views/Inspector/ViolationsListView.swift
- Verificar/Views/Inspector/ViolationDetailView.swift
- Verificar/Views/Inspector/StructureTreeView.swift
- Verificar/Models/StructureNodeModel.swift
- Verificar/ViewModels/StructureTreeViewModel.swift
- Verificar/Views/Inspector/FeaturePanel.swift
- Verificar/ViewModels/FeatureViewModel.swift
- Verificar/Info.plist (updated)

### Directories Created
- Verificar/App/
- Verificar/Models/
- Verificar/Views/
- Verificar/Views/PDF/
- Verificar/Views/Sidebar/
- Verificar/Views/Inspector/
- Verificar/Views/Toolbar/
- Verificar/ViewModels/
- Verificar/Services/
- Verificar/Utilities/

### Files Deleted
- Verificar/Item.swift (SwiftData model - not needed)
- Verificar/VerificarApp.swift (moved to App/VerificarApp.swift)
- Verificar/ContentView.swift (moved to Views/ContentView.swift)

### Tests
- VerificarTests/VerificarTests.swift (template - 1 test)
- VerificarTests/PDFDocumentModelTests.swift (8 tests)
- VerificarTests/PDFViewRepresentableTests.swift (4 tests)
- VerificarTests/ThumbnailSidebarTests.swift (5 tests)
- VerificarTests/OutlineNodeTests.swift (8 tests)
- VerificarTests/ToolbarTests.swift (18 tests)
- VerificarTests/ValidationServiceTests.swift (15 tests)
- VerificarTests/DocumentViewModelTests.swift (24 tests: 6 DocumentViewModel + 18 ValidationViewModel)
- VerificarTests/StandardsPanelTests.swift (14 tests)
- VerificarTests/ViolationsListViewModelTests.swift (11 tests)
- VerificarTests/ViolationDetailTests.swift (15 tests)
- VerificarTests/StructureTreeViewModelTests.swift (21 tests)
- VerificarTests/FeatureViewModelTests.swift (19 tests)

## Notes
### Sprint 1
- Removed all SwiftData boilerplate (Item.swift, migration plan, versioned schema, @Query, modelContext)
- Removed SwiftData and UniformTypeIdentifiers imports from app entry point
- Simplified VerificarApp to use WindowGroup instead of DocumentGroup
- Replaced com.example.item-document UTType with com.adobe.pdf in Info.plist
- Removed UTImportedTypeDeclarations section from Info.plist
- Set CFBundleTypeRole to Viewer and LSHandlerRank to Alternate for PDF documents
- Created full directory structure for future sprints
- ContentView shows placeholder with SF Symbol and instructional text
- Build settings note: Project uses SWIFT_DEFAULT_ACTOR_ISOLATION = MainActor and SWIFT_APPROACHABLE_CONCURRENCY = YES (Xcode 26.2 defaults)
- Project uses PBXFileSystemSynchronizedRootGroup so new files in the Verificar/ directory are auto-discovered by Xcode (no pbxproj edits needed for file additions)

### Sprint 2
- Created PDFDocumentModel (@Observable class wrapping PDFKit.PDFDocument)
  - Properties: pdfDocument, url, isLoading, error, currentPageIndex, pageCount, currentPage, title, isDocumentLoaded
  - Methods: open(url:), close(), goToPage(_:), nextPage(), previousPage()
  - goToPage clamps index to valid range [0, pageCount-1]
  - title falls back to filename when PDF metadata has no title
  - PDFDocumentError enum for typed load failures
- Updated VerificarApp with:
  - @State documentModel injected via .environment() into ContentView
  - .fileImporter with UTType.pdf filter for File > Open dialog
  - CommandGroup(replacing: .newItem) providing Cmd+O "Open..." menu item
  - Drag-and-drop support via .onDrop for PDF files and file URLs
  - Security-scoped resource access for sandboxed file opening
- Updated ContentView to:
  - Read PDFDocumentModel from @Environment
  - Show placeholder when no document loaded
  - Show loading spinner during document load
  - Show document title and page count when document loaded
- Added 8 unit tests in PDFDocumentModelTests using Swift Testing:
  - initialState, goToPageClamping, nextAndPreviousPage, pageCountReflectsDocument
  - currentPageReturnsCorrectPage, closeResetsState, titleFromFilename, goToPageNoDocument
  - Tests use programmatically created in-memory PDFDocuments (no test file dependencies)

### Sprint 3
- Created PDFViewRepresentable (NSViewRepresentable wrapping PDFKit.PDFView)
  - Configures PDFView: autoScales=true, displayMode=.singlePageContinuous, displayDirection=.vertical
  - Coordinator pattern with PDFViewDelegate for page-change notifications
  - Observes .PDFViewPageChanged notification to sync currentPageIndex back to model
  - updateNSView assigns document only when reference changes (identity check with !==)
  - Syncs model's currentPage to PDFView.go(to:) when page index differs
  - dismantleNSView removes notification observer to prevent leaks
- Created PDFRenderView (container view wrapping PDFViewRepresentable)
  - Shows loading overlay with ProgressView when documentModel.isLoading
  - Shows "No Document" overlay when no document is loaded
  - Shows PDFViewRepresentable when document is loaded and ready
- Updated ContentView:
  - Replaced Sprint 2 placeholder documentLoadedView with PDFRenderView
  - PDFRenderView handles both loading and loaded states
  - Placeholder view retained for no-document state
  - Removed unused loadingView and documentLoadedView subviews
- Added 4 unit tests in PDFViewRepresentableTests using Swift Testing:
  - makeNSViewCreatesPDFView: verifies PDFView is configured with correct autoScales, displayMode, displayDirection, and delegate
  - updateNSViewAssignsDocument: verifies PDFDocument is assigned to the PDFView after update
  - updateNSViewSkipsSameDocument: verifies no reassignment when document reference is unchanged
  - coordinatorUpdatesModelOnPageChange: verifies Coordinator syncs page index back to model on page change notification
  - Tests use a _PDFViewTestContext helper to bypass NSViewRepresentable.Context creation

### Sprint 4
- Replaced single-column ContentView with NavigationSplitView three-column layout
  - Sidebar column: SidebarView with min 180, ideal 220, max 300 width
  - Content column: PDFRenderView with min 400 width
  - Detail/Inspector column: InspectorView with min 280, ideal 320, max 450 width
  - Overall window min size: 800x500
  - @State sidebarVisibility controls sidebar show/hide via NavigationSplitViewVisibility
  - @State isInspectorPresented controls inspector show/hide
  - toggleSidebar() switches between .detailOnly and .all
  - toggleInspector() toggles isInspectorPresented boolean
- Created SidebarView (Views/Sidebar/SidebarView.swift)
  - Segmented Picker toggles between Thumbnails and Outline modes (SidebarMode enum)
  - Placeholder content for each mode with contextual text (loaded vs not loaded)
  - Reads PDFDocumentModel from @Environment
  - SidebarMode enum: .thumbnails, .outline with label and icon properties
- Created InspectorView (Views/Inspector/InspectorView.swift)
  - Segmented Picker toggles between four tabs (InspectorTab enum)
  - Tabs: Standards, Violations, Structure, Features
  - Each tab shows placeholder with icon, title, and contextual subtitle
  - Reads PDFDocumentModel from @Environment
  - InspectorTab enum: .standards, .violations, .structure, .features with label and icon properties
- Added keyboard shortcuts via menu commands:
  - Cmd+Opt+1: Toggle Sidebar
  - Cmd+Opt+2: Toggle Inspector
  - Menu items added under View > (after .sidebar CommandGroup)
- FocusedValues bridge for menu-to-view communication:
  - ToggleSidebarActionKey and ToggleInspectorActionKey FocusedValueKey types
  - ContentView publishes toggleSidebar/toggleInspector via .focusedSceneValue
  - VerificarApp reads focused values via @FocusedValue to forward menu actions
- No new tests added (Sprint 4 specifies "Build verification" only per execution plan)
- NavigationSplitViewVisibility is a struct, not an enum — used if/else instead of switch for toggle logic

### Sprint 5
- Created ThumbnailSidebarView (Views/Sidebar/ThumbnailSidebarView.swift)
  - ScrollViewReader + LazyVStack displays page thumbnails for the loaded PDF
  - Each thumbnail cell: rendered page image via PDFPage.thumbnailImage(width:) + page number label
  - Thumbnail rendered at 2x requested width for Retina quality, displayed at ~120pt wide
  - Selected page highlighted with accent color border (3pt) and enhanced shadow
  - Click thumbnail calls documentModel.goToPage(_:) to update currentPageIndex
  - Auto-scroll to current page via .onChange(of: documentModel.currentPageIndex) with smooth animation
  - Also scrolls to current page on .onAppear for initial positioning
  - Fallback placeholder for pages that fail to render (doc icon in gray rectangle)
  - Empty state view when no document is loaded
  - Full accessibility support: each thumbnail has accessibilityLabel and isSelected trait
- Created PDFKitExtensions (Utilities/PDFKitExtensions.swift)
  - PDFPage.thumbnailImage(width:) — generates thumbnail at given width preserving aspect ratio
    - Uses page mediaBox bounds to compute correct aspect ratio
    - Returns empty NSImage if page has zero-size bounds (defensive)
    - Calls PDFPage.thumbnail(of:for:) with computed size
  - PDFDocument.allPages — returns [PDFPage] array of all pages in document order
  - PDFDocument.indexedPages — returns [(index: Int, page: PDFPage)] tuples for iteration
- Updated SidebarView (Views/Sidebar/SidebarView.swift)
  - Replaced thumbnailsPlaceholder with ThumbnailSidebarView() in the Thumbnails tab
  - ThumbnailSidebarView handles its own empty state when no document is loaded
- Added 5 unit tests in ThumbnailSidebarTests using Swift Testing:
  - thumbnailImageGeneratesCorrectSize: verifies PDFPage.thumbnailImage returns non-zero-sized image
  - allPagesReturnsCorrectCount: verifies PDFDocument.allPages returns all pages in order with identity checks
  - indexedPagesReturnsCorrectPairs: verifies index-page tuples have correct indices
  - pageSelectionUpdatesModel: verifies goToPage updates currentPageIndex and clamps out-of-bounds values
  - emptyDocumentThumbnail: verifies empty document produces empty allPages and indexedPages arrays

### Sprint 6
- Created OutlineNode (Models/OutlineNode.swift)
  - struct OutlineNode: Identifiable wrapping PDFOutline data
  - Properties: id (UUID), label (String), destination (PDFDestination?), children ([OutlineNode])
  - Static buildTree(from:) converts PDFOutline root into [OutlineNode] array
  - Private buildNode(from:) recursively converts each PDFOutline node
  - Handles nil and empty-string labels gracefully (falls back to "Untitled")
    - PDFOutline.label can return empty string instead of nil depending on framework state
- Created OutlineSidebarView (Views/Sidebar/OutlineSidebarView.swift)
  - Displays document outline as collapsible tree using DisclosureGroup
  - OutlineNodeRow renders each node: leaf nodes as clickable buttons, parent nodes as DisclosureGroups
  - First-level nodes expanded by default (isExpanded initialized to true)
  - Click navigates to outline destination via documentModel.navigateToDestination(_:)
  - Each node shows doc.text icon + label text with 2-line truncation
  - Three states: no document loaded, document with no outline, document with outline
  - Full accessibility support with accessibilityLabel on each node
- Updated SidebarView (Views/Sidebar/SidebarView.swift)
  - Replaced outlinePlaceholder with OutlineSidebarView() in the Outline tab
  - OutlineSidebarView handles its own empty states
- Updated PDFDocumentModel (Models/PDFDocumentModel.swift)
  - Added outlineRoot computed property: PDFOutline? from pdfDocument?.outlineRoot
  - Added hasOutline computed property: checks if outlineRoot has children
  - Added navigateToDestination(_:) method: extracts page from PDFDestination, gets its index, calls goToPage(_:)
- Added 8 unit tests in OutlineNodeTests using Swift Testing:
  - buildTreeCreatesNodes: verifies top-level children are converted to OutlineNode array
  - buildTreeHandlesNestedChildren: verifies recursive tree building 3 levels deep
  - buildTreeEmptyOutline: verifies empty root produces empty array
  - buildTreeNilLabel: verifies nil/empty label falls back to "Untitled"
  - nodePreservesDestination: verifies PDFDestination is preserved through conversion
  - nodesHaveUniqueIds: verifies all nodes get distinct UUIDs
  - hasOutlineFalseWhenNoDocument: verifies PDFDocumentModel.hasOutline/outlineRoot when empty
  - navigateToDestinationUpdatesPage: verifies navigateToDestination updates currentPageIndex

### Sprint 7
- Created VerificarToolbar (Views/Toolbar/ToolbarContent.swift)
  - struct VerificarToolbar: ToolbarContent providing full toolbar UI
  - Navigation group: Back/Forward page buttons, page indicator ("Page 3 of 12"), Go To Page text field
  - Zoom group: Zoom In (+), Zoom Out (-), zoom percentage display, zoom presets menu (Fit Page, Fit Width, Actual Size, 50%-200%)
  - View mode group: Segmented control for Single Page / Continuous / Two-Up using ViewModeOption enum
  - Search group: Toggle search field with inline search, result count display, and clear button
  - All controls disabled when no document is loaded
  - ViewModeOption enum: CaseIterable, Identifiable, maps to/from PDFDisplayMode
- Updated PDFDocumentModel (Models/PDFDocumentModel.swift)
  - Added zoom properties: zoomLevel (CGFloat, default 1.0), autoScalesEnabled (Bool), fitWidthRequested (Bool)
  - Added displayMode (PDFDisplayMode, default .singlePageContinuous)
  - Added search properties: isSearching (Bool), searchText (String), searchResults ([PDFSelection])
  - Added zoom methods: zoomIn(), zoomOut(), zoomToFit(), zoomToWidth(), zoomToActualSize(), setZoom(_:)
  - Zoom clamped to [0.25, 8.0] range via static minZoom/maxZoom constants
  - Zoom step is 0.25 per increment/decrement
  - Added zoomPercentage computed property (Int, e.g. 125 for 1.25x)
  - Added search methods: search(_:), clearSearch()
  - Updated close() to reset all new properties
- Updated PDFViewRepresentable (Views/PDF/PDFViewRepresentable.swift)
  - Reacts to displayMode changes on the model
  - Reacts to zoom level changes: supports autoScalesEnabled, fitWidthRequested, and manual zoom
  - Observes .PDFViewScaleChanged to sync scale factor back to model
  - Handles search text changes: uses PDFDocument.findString() for search, highlights results via pdfView.highlightedSelections
  - Navigates to first search result automatically
  - isUpdating flag on Coordinator prevents feedback loops between model and view
- Updated ContentView (Views/ContentView.swift)
  - Added .toolbar { VerificarToolbar(documentModel:) } to NavigationSplitView
- Updated VerificarApp (App/VerificarApp.swift)
  - Added View menu items: Zoom In (Cmd+=), Zoom Out (Cmd+-), Actual Size (Cmd+0), Zoom to Fit (Cmd+9), Zoom to Width
  - Added View menu items: Single Page, Continuous, Two-Up display mode switching
  - Added Edit menu item: Find... (Cmd+F) to toggle search
  - Added Go menu: Next Page (Cmd+Right), Previous Page (Cmd+Left), First Page, Last Page, Go to Page... (Opt+Cmd+P)
  - Added Go to Page sheet with text input and validation
- Added 18 unit tests in ToolbarTests using Swift Testing:
  - Zoom tests: zoomInIncrements, zoomOutDecrements, zoomClampedToMin, zoomClampedToMax, zoomOutDoesNotGoBelowMin, zoomInDoesNotExceedMax, zoomToActualSize, zoomToFitEnablesAutoScales, zoomToWidthSetsFlag, zoomPercentage
  - Display mode tests: defaultDisplayMode, displayModeChanges
  - Search tests: searchSetsText, clearSearchResetsState, searchWithEmptyStringClears
  - Integration tests: closeResetsNewProperties
  - ViewModeOption tests: viewModeOptionMapping, viewModeOptionFromDisplayMode

### Sprint 8
- Added SwiftVerificar-biblioteca as SPM dependency
  - XCRemoteSwiftPackageReference for https://github.com/intrusive-memory/SwiftVerificar-biblioteca.git v0.1.0
  - XCSwiftPackageProductDependency for SwiftVerificarBiblioteca linked to Verificar target
  - Package dependency resolved successfully with all transitive dependencies (parser, validation, validation-profiles, wcag-algs)
- Created ValidationService (Services/ValidationService.swift)
  - @Observable class wrapping SwiftVerificar.shared for UI-observable validation state
  - Properties: isValidating (Bool), progress (Double 0-1), lastResult (ValidationResult?), error (Error?)
  - validate(url:) delegates to validate(url:profile:) with default "PDF/UA-2"
  - validate(url:profile:) runs validation via Task, reports progress, handles errors
  - extractFeatures(url:) uses ProcessorConfig with .extractFeatures task
  - cancelValidation() cancels in-flight task and resets isValidating
  - @unchecked Sendable due to @Observable macro requirements
- Created ValidationState models (Models/ValidationState.swift)
  - ValidationSummary: aggregated summary with passRate, complianceStatus computed properties
  - ViolationItem: Identifiable, Sendable, Equatable with full WCAG/specification metadata
  - ViolationSeverity: error/warning/info with icon (SF Symbol) and color (SwiftUI Color)
  - ComplianceStatus: conformant/nonConformant(errors:)/unknown/inProgress/notValidated with label, icon, color
  - ValidationStateMapper: maps biblioteca types to UI models
    - makeSummary(from:) maps ValidationResult to ValidationSummary
    - makeViolations(from:) maps failed/unknown assertions to ViolationItem array
    - Maps assertion.status == .failed to .error severity, .unknown to .warning
    - Converts 1-based page numbers to 0-based page indices
- Added 15 unit tests in ValidationServiceTests using Swift Testing:
  - ValidationService: serviceInitializesWithDefaultState, cancelSetsIsValidatingToFalse, validateSetsErrorForStubImplementation, validateResetsStateBeforeStarting
  - ValidationState Models: violationSeverityIcons, violationSeverityAllCases, complianceStatusLabels, complianceStatusEquality, validationSummaryPassRate, validationSummaryPassRateZeroTotal, validationSummaryConformant, validationSummaryNonConformant
  - ValidationStateMapper: mapperCreatesSummary, mapperCreatesViolations, mapperHandlesEmptyResult

### Sprint 9
- Created DocumentViewModel (ViewModels/DocumentViewModel.swift)
  - @Observable class that owns PDFDocumentModel, ValidationService, and ValidationViewModel
  - Central orchestrator for the document lifecycle and validation pipeline
  - Properties: selectedProfile (String, default "PDF/UA-2"), autoValidateOnOpen (Bool, default true)
  - Computed: validationSummary (from ValidationStateMapper), violations (from ValidationStateMapper), complianceStatus (derived from validation state)
  - openDocument(at:) — cancels existing validation, clears state, opens PDF, auto-validates if enabled
  - validate() — validates current document with selected profile, maps results to ValidationViewModel
  - revalidate() — convenience wrapper for validate()
  - selectViolation(_:) — sets selectedViolation on ValidationViewModel and navigates PDF to violation page
- Created ValidationViewModel (ViewModels/ValidationViewModel.swift)
  - @Observable class managing filtered, sorted, and grouped violation lists
  - Properties: violations, selectedViolation, filterSeverity, searchText, groupBy
  - GroupingMode enum: .none, .severity, .category, .page (CaseIterable, Identifiable)
  - filteredViolations computed property: combines severity filter + text search (case-insensitive)
  - groupedViolations computed property: groups filtered violations by selected mode
  - Severity counts: errorCount, warningCount, infoCount
  - summaryText computed property: e.g. "4 violations (2 errors, 1 warning, 1 info)"
  - updateViolations(_:) replaces violations and clears selection
  - clearViolations() resets all state including filters
  - Grouping helpers: groupBySeverity, groupByCategory, groupByPage (with numeric sort)
- Updated VerificarApp (App/VerificarApp.swift)
  - Replaced @State PDFDocumentModel with @State DocumentViewModel
  - Added convenience documentModel property for menu command access
  - Injects DocumentViewModel, PDFDocumentModel, ValidationService, and ValidationViewModel into environment
  - openDocument(at:) now delegates to documentViewModel.openDocument(at:) which triggers auto-validation
  - File importer and drag-and-drop handlers unchanged but route through DocumentViewModel
- Updated ContentView (Views/ContentView.swift)
  - Added @Environment(DocumentViewModel.self) for parent view model access
  - Retains @Environment(PDFDocumentModel.self) for sidebar, toolbar, and PDF rendering
  - Updated preview to inject all four environment objects
- Updated InspectorView (Views/Inspector/InspectorView.swift)
  - Now reads DocumentViewModel, ValidationService, and PDFDocumentModel from environment
  - Shows linear ProgressView with percentage when validationService.isValidating
  - Standards tab: shows compliance badge + summary stats when results available
    - Displays complianceStatus icon/label, profile name, passed/failed/warning stat badges
    - Shows "Validation Error" state when service has error
    - Shows "Not Validated" when document loaded but not yet validated
    - Shows "Open a PDF" when no document loaded
  - Violations tab: shows summary text + scrollable violation list when results available
    - Each row: severity icon, rule ID, message, page number
    - Tap violation calls documentViewModel.selectViolation(_:) to navigate PDF
    - Shows "No Violations" when validation ran but found none
    - Shows "Not Validated" / "Open a PDF" for appropriate empty states
  - Structure and Features tabs retain previous placeholder content
- Added 24 unit tests in DocumentViewModelTests using Swift Testing:
  - DocumentViewModel (6 tests): initialState, complianceStatusNotValidated, selectViolationNavigates, selectViolationNilPage, openDocumentFailure, openDocumentClearsPreviousState
  - ValidationViewModel (18 tests): filterBySeverityError, filterBySeverityWarning, filterBySeverityInfo, noFilterReturnsAll, searchByMessage, searchByRuleID, searchCaseInsensitive, combinedFilterAndSearch, emptySearchReturnsAll, groupBySeverity, groupByPage, groupByNone, summaryText, summaryTextEmpty, updateViolationsReplacesAndClearsSelection, clearViolationsResetsEverything, groupingModeCases, severityCounts

### Sprint 10
- Created StandardsPanel (Views/Inspector/StandardsPanel.swift)
  - Full accessibility standards inspector panel replacing the Sprint 9 inline placeholder
  - Compliance Badge: large icon (48pt) with compliance status label, profile name, and duration
  - Summary Bar: horizontal stacked bar (green/red/orange/gray) showing passed/failed/warning/N-A proportions
    - Legend row with colored circles and counts for each category
    - GeometryReader-based proportional width calculation
  - Standards Identification Section: PDF/A, PDF/UA, and WCAG identification derived from selected profile
    - PDF/A shows profile name when PDF/A profile selected, otherwise "Not declared"
    - PDF/UA shows profile name when PDF/UA profile selected, otherwise "Not declared"
    - WCAG shows "Not assessed" (placeholder for future WCAG analysis)
  - Metadata Section: reads PDFDocument.documentAttributes for Title, Author, Subject, Keywords, Created, Modified, Producer, Creator, PDF Version
    - Handles [AnyHashable: Any]? dictionary type from PDFKit
    - Keywords supports both [String] array and String value formats
    - Dates formatted with .abbreviated date and .shortened time
    - PDF version from PDFDocument.majorVersion/minorVersion
    - Text selection enabled on metadata values
  - Validation Controls: Profile picker (11 profiles) + bordered prominent Validate button
    - Uses @Bindable for two-way binding to documentViewModel.selectedProfile
    - Button triggers documentViewModel.revalidate() in a Task
    - Disabled when no document loaded or validation in progress
  - State Views: validating (spinner), error (with retry button), no document (placeholder), not validated (placeholder + controls)
  - Available profiles: PDF/UA-1, PDF/UA-2, PDF/A-1a through PDF/A-4 (11 total)
  - StandardsPanelHelper enum: testable helper with BadgeState mapping, SummaryStats extraction, and standards identification logic
  - Full accessibility support with accessibilityLabel and accessibilityElement(children: .combine)
- Updated InspectorView (Views/Inspector/InspectorView.swift)
  - Replaced inline standardsTabContent with StandardsPanel() view
  - Removed old statBadge helper (no longer needed)
  - Standards tab now delegates entirely to StandardsPanel
- Added 14 unit tests in StandardsPanelTests using Swift Testing:
  - Summary computation (3 tests): summaryStatsComputed, summaryStatsZeroTotal, summaryStatsAllPassed
  - Badge state mapping (5 tests): badgeStateConformant, badgeStateNonConformant, badgeStateUnknown, badgeStateInProgress, badgeStateNotValidated
  - Standards identification (4 tests): pdfAIdentificationForPDFAProfile, pdfAIdentificationForNonPDFAProfile, pdfUAIdentificationForPDFUAProfile, pdfUAIdentificationForNonPDFUAProfile
  - Profile list (1 test): availableProfilesContainsExpected (verifies all 11 profiles)
  - Badge state uniqueness (1 test): badgeStateRawValues (verifies all raw values are distinct)

### Sprint 11
- Created ViolationsListView (Views/Inspector/ViolationsListView.swift)
  - Full violations list inspector tab replacing the Sprint 9 inline placeholder
  - Filter Bar: segmented control for severity (All / Errors / Warnings / Info) + search field with clear button
  - Summary Bar: shows summaryText from ValidationViewModel + grouping mode picker (Menu)
  - Grouped List: groups violations by severity/category/page/none using disclosure sections
    - Each violation row: severity icon (colored), Rule ID badge, WCAG criterion tag, message (2-line truncation), page number badge
    - Selected violation highlighted with accent color background
    - Click calls documentViewModel.selectViolation(_:) to navigate PDF to violation page
  - Context Menu: Copy violation details (to pasteboard), Go to page, Group by options
  - Empty States: validating (hourglass), no document, not validated, clean (green checkmark), no matches (magnifying glass)
  - ViolationRow: private subview for individual violation display with full accessibility support
  - ViolationsListHelper: testable enum with formatViolationDetails(_:) and badgeCount(from:)
  - ViolationSeverity.filterLabel extension for segmented control labels
  - Preview providers for "With Violations" and "Clean" states
- Updated InspectorView (Views/Inspector/InspectorView.swift)
  - Replaced inline violationsTabContent with ViolationsListView()
  - Replaced segmented Picker tab bar with custom HStack button-based tab bar
  - Added badge count on Violations tab: red capsule with error count (only shown when errorCount > 0)
  - Tab buttons use accent color background for selected state and accessibility traits
  - Removed all Sprint 9 violations inline view code (List, HStack rows, etc.)
- ValidationViewModel unchanged (all filtering, grouping, and search logic was already complete from Sprint 9)
- Added 11 unit tests in ViolationsListViewModelTests using Swift Testing:
  - Badge count (3 tests): badgeCountReturnsErrorCount, badgeCountZeroWhenNoErrors, badgeCountZeroWhenEmpty
  - Format details (3 tests): formatDetailsIncludesAllFields, formatDetailsOmitsNilFields, formatDetailsShowsOneBasedPage
  - Filter labels (1 test): severityFilterLabels
  - Grouping with filters (3 tests): groupedViolationsRespectFilter, groupedViolationsRespectSearch, groupByCategoryProducesPrincipleGroups
  - Selection (1 test): selectingViolationUpdatesState

### Sprint 12
- Created ViolationDetailView (Views/Inspector/ViolationDetailView.swift)
  - Expandable inline detail view shown when a violation is selected in the list
  - Header section: severity badge icon + rule ID (headline) + short description (subheadline)
  - Specification Reference section: displays specification string with doc.text icon
  - Location section: formatted page number (1-based), object type, structure tree path
  - WCAG Mapping section: principle, success criterion (number + name), level (A/AA/AAA)
    - Blue-tinted background for visual distinction
    - Full WCAG 2.1 criterion name lookup (78 criteria mapped)
    - Level formatting adds "Level " prefix (avoids double-prefix)
  - Details section: full description (only shown when different from message)
  - Context section: monospaced font excerpt with gray background
  - Remediation section: suggested fix with green-tinted background
  - Navigate button: "Show in PDF" borderedProminent button triggers onShowInPDF callback
  - All text fields support text selection (.textSelection(.enabled))
  - Full accessibility support with accessibilityLabel and accessibilityElement
  - ViolationDetailHelper: testable enum with formatting logic
    - formatLocation(pageIndex:objectType:context:) builds readable location string
    - wcagCriterionName(_:) maps WCAG 2.1 criterion numbers to names
    - formatWCAGLevel(_:) adds "Level " prefix without double-prefixing
    - formatRemediation(_:) combines remediation text with WCAG reference
    - wcagCriterionMap: complete WCAG 2.1 dictionary (78 criteria across 4 principles)
  - Preview providers for full and minimal violation states
- Updated ViolationsListView (Views/Inspector/ViolationsListView.swift)
  - Added @State expandedViolationID: String? for inline disclosure tracking
  - Replaced direct onTapGesture with violationCell(_:valVM:) method
  - violationCell renders ViolationRow + conditional ViolationDetailView
  - Tap toggles expansion with easeInOut animation (0.2s)
  - Expanded cell has lighter accent background (0.08 opacity)
  - "Show in PDF" button in detail calls documentViewModel.selectViolation(_:)
  - ViolationRow updated with isExpanded parameter for disclosure chevron
    - Shows chevron.right (collapsed) or chevron.down (expanded)
    - Accessibility label includes "expanded" / "collapsed" state
- Added 15 unit tests in ViolationDetailTests using Swift Testing:
  - WCAG criterion formatting (5 tests): knownWCAGCriterionName, unknownWCAGCriterionName, wcagLevelFormatting, wcagLevelNoDoublePrefix, allPrinciplesHaveCriteria
  - Remediation text generation (4 tests): formatRemediationWithWCAG, formatRemediationNilWhenNoRemediation, formatRemediationWithoutWCAG, formatRemediationWithUnknownCriterion
  - Location formatting (4 tests): formatLocationFull, formatLocationPageOnly, formatLocationNoPage, formatLocationObjectTypeNoPage
  - WCAG criterion map coverage (2 tests): wcagCriterionMapCount, wcagCriterionMapValuesNonEmpty

### Sprint 13
- Created StructureNodeModel (Models/StructureNodeModel.swift)
  - struct StructureNodeModel: Identifiable, Sendable, Equatable for UI-friendly structure tree nodes
  - Properties: id (String), type (String), title (String?), altText (String?), language (String?), children ([StructureNodeModel]), pageIndex (Int?), hasViolation (Bool)
  - Computed: icon (SF Symbol name), displayLabel (title or altText or type), isHeading, isFigure, isTable, isList
  - Static iconForType(_:) maps 30+ PDF structure element types to SF Symbols (headings H1-H6, grouping, block-level, table, list, inline elements)
  - StructureNodeStatistics: totalElements, headingCount, figureCount, tableCount, listCount, paragraphCount, linkCount, typeCounts dictionary
  - StructureTreeBuilder enum: computeStatistics(for:), filterNodes(_:matching:), makeSampleTree()
  - filterNodes uses recursive tree walk: parent included if child matches, case-insensitive matching on type/title/altText
- Created StructureTreeViewModel (ViewModels/StructureTreeViewModel.swift)
  - @Observable class managing structure tree display, search, selection, and statistics
  - Properties: rootNodes ([StructureNodeModel]), selectedNode (StructureNodeModel?), searchText (String)
  - Computed: displayNodes (filtered by search), statistics (StructureNodeStatistics), hasStructureTree, isSearching, displayedNodeCount
  - Methods: updateTree(_:), clearTree(), selectNode(_:), markViolations(from:)
  - markViolations cross-references ViolationItem page indices and object types with tree nodes
- Created StructureTreeView (Views/Inspector/StructureTreeView.swift)
  - Recursive tree display using LazyVStack with nested StructureNodeRow views
  - StructureNodeRow: expandable/collapsible for parent nodes, shows icon + type (monospaced) + title/altText + page badge + violation indicator
  - Depth-based indentation (16pt per level) with disclosure chevrons for parent nodes
  - Selected node highlighted with accent color background
  - Click node navigates PDF via documentModel.goToPage(_:)
  - Search bar: filter tree nodes by type or content with clear button
  - Info bar: scrollable stat badges showing Total, Headings, Figures, Tables, Lists counts
  - Color coding: nodes with violations shown in red (icon, type label, exclamation triangle badge)
  - Empty state: "No structure tree found -- this PDF is not tagged" with orange warning icon
  - No-document state: "Open a PDF to view its structure tree"
  - No-matches state: magnifying glass when search yields no results
  - Full accessibility support with accessibilityLabel on every interactive element
  - Loads structure from validation results on appear and on document change
- Updated InspectorView (Views/Inspector/InspectorView.swift)
  - Replaced Structure tab placeholder with StructureTreeView()
- Added 21 unit tests in StructureTreeViewModelTests using Swift Testing:
  - Tree building (3 tests): updateTreeSetsRootNodes, clearTreeRemovesAll, hasStructureTreeReflectsPresence
  - Statistics (3 tests): statisticsComputeCorrectCounts, statisticsTypeCountsAreCorrect, emptyTreeStatisticsZero
  - Search filtering (6 tests): searchFiltersByType, searchFiltersByTitle, searchFiltersByAltText, emptySearchReturnsAll, searchNoMatchesReturnsEmpty, searchIsCaseInsensitive
  - Node selection (2 tests): selectNodeSetsSelection, selectNodeNilDeselects
  - Node model (4 tests): nodeIconsAreCorrect, nodeIsHeadingDetection, nodeDisplayLabel, nodeTypeDetection
  - Violation marking (1 test): markViolationsFlags
  - Integration (2 tests): sampleTreeWellFormed, displayedNodeCountMatchesTotal

### Sprint 14
- Created FeatureViewModel (ViewModels/FeatureViewModel.swift)
  - @Observable class managing extracted PDF feature data for the Feature panel
  - Properties: fonts ([FontFeature]), images ([ImageFeature]), colorSpaces ([ColorSpaceFeature]), annotations ([AnnotationFeature]), isExtracting (Bool), hasExtractedFeatures (Bool)
  - Computed: summary (FeatureSummary with totals and warning counts for each category)
  - Methods: extractFeatures(from:), extractFeaturesFromDocument(_:), clearFeatures(), updateFeatures(fonts:images:colorSpaces:annotations:)
  - Extracts fonts via PDFPage.attributedString font attribute enumeration
  - Extracts annotations via PDFPage.annotations with accessible name detection (fieldName, toolTip)
  - Color space detection from document content (heuristic, placeholder for real biblioteca extraction)
- Created Feature Model Types:
  - FontFeature: Identifiable, Sendable, Equatable with name, type (Type1/TrueType/CID/Type3/OpenType/Unknown), isEmbedded, usedOnPages
  - ImageFeature: Identifiable, Sendable, Equatable with width, height, colorSpace, hasAltText, pageIndex, dimensionsLabel computed
  - ColorSpaceFeature: Identifiable, Sendable, Equatable with name, type (DeviceRGB/DeviceCMYK/DeviceGray/ICCBased/CalRGB/CalGray/Lab/Indexed/Separation/DeviceN/Pattern/Unknown), usageCount, isDeviceDependent computed
  - AnnotationFeature: Identifiable, Sendable, Equatable with type, pageIndex, hasAccessibleName
  - FeatureSummary: totals and warning counts (nonEmbeddedFontCount, imagesWithoutAltTextCount, deviceDependentColorSpaceCount, annotationsWithoutAccessibleNameCount)
- Created FeatureExtractionHelper enum:
  - classifyFontType(_:) heuristic font type classification from name patterns
  - isFontLikelyEmbedded(_:) checks for subset prefix ("+") pattern
  - classifyColorSpaceType(_:) maps color space names to typed enum
  - formatPageList(_:) formats zero-based page indices as 1-based list with truncation for >5 pages
- Created FeaturePanel (Views/Inspector/FeaturePanel.swift)
  - Tabbed sub-panel with four tabs: Fonts, Images, Colors, Annotations (FeatureTab enum)
  - Summary bar at top: total counts per category with warning counts in orange parentheses
  - Fonts tab: table with Font Name, Type, Embedded (checkmark/xmark), Pages columns
    - Non-embedded fonts highlighted with orange text and orange background tint
  - Images tab: table with Dimensions, Color Space, Alt Text (checkmark/xmark), Page columns
    - Images without alt text highlighted with red background tint
  - Color Spaces tab: table with Name, Type, Usage Count columns
    - Device-dependent color spaces highlighted with orange warning icon and tint
  - Annotations tab: table with Type, Accessible Name (checkmark/xmark), Page columns
  - Empty state per tab when no items of that type found
  - Overall empty states: no document, extracting (spinner), not yet extracted (with manual Extract button)
  - Automatic feature extraction on document load via onAppear and onChange
  - Full accessibility support with accessibilityLabel on every row
- Updated InspectorView (Views/Inspector/InspectorView.swift)
  - Replaced Features tab placeholder with FeaturePanel()
- Added 19 unit tests in FeatureViewModelTests using Swift Testing:
  - Initial state (1 test): initialState
  - Summary statistics (3 tests): summaryComputesCorrectTotals, summaryComputesCorrectWarnings, summaryZeroWhenEmpty
  - Update & Clear (2 tests): updateFeaturesSetsData, clearFeaturesResetsAll
  - Feature categorization (3 tests): fontTypeCoverage, colorSpaceDeviceDependency, imageDimensionsLabel
  - FeatureExtractionHelper (6 tests): classifyFontTypeTrueType, classifyFontTypeType1, classifyFontTypeUnknown, isFontEmbeddedSubsetPrefix, classifyColorSpaceType, formatPageList
  - Page list formatting (1 test): formatPageListTruncation
  - FeatureTab enum (2 tests): featureTabCases, featureTabIcons
